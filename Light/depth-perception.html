<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Depth Perception</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #1a1a2e;
            color: #eee;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            max-width: 600px;
            margin: 0 auto;
            user-select: none;
        }
        #instructions {
            margin: 12px 0 8px;
            font-size: 14px;
            color: #aaa;
            text-align: center;
        }
        #controls {
            margin-bottom: 8px;
        }
        button {
            background: #3a3a5c;
            color: #eee;
            border: 1px solid #555;
            padding: 6px 18px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover { background: #50507a; }
        canvas {
            border: 1px solid #333;
            border-radius: 6px;
            cursor: crosshair;
            background: #12121f;
        }
        #status {
            margin-top: 8px;
            font-size: 13px;
            color: #888;
            height: 20px;
        }
    </style>
</head>
<body>
    <p id="instructions">Click once to start an arrow, click again to place the arrowhead.</p>
    <div id="controls">
        <button id="resetBtn">Reset</button>
    </div>
    <canvas id="canvas" width="580" height="520"></canvas>
    <p id="status"></p>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const statusEl = document.getElementById('status');
        const resetBtn = document.getElementById('resetBtn');

        // Layout constants
        const W = canvas.width;
        const H = canvas.height;
        const eyeY = 80;
        const eyeSep = 110;
        const leftEyeX = W / 2 - eyeSep / 2;
        const rightEyeX = W / 2 + eyeSep / 2;
        const blueDotY = 250;
        const redDotY = 420; // twice as far from eyes as blue dot
        const dotX = W / 2;

        // State
        let arrows = [];
        let startPoint = null;
        let mousePos = null;

        function drawEye(cx, cy, radius) {
            // White of eye
            ctx.beginPath();
            ctx.ellipse(cx, cy, radius * 1.5, radius, 0, 0, Math.PI * 2);
            ctx.fillStyle = '#f0f0f0';
            ctx.fill();
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();

            // Iris
            ctx.beginPath();
            ctx.arc(cx, cy, radius * 0.6, 0, Math.PI * 2);
            ctx.fillStyle = '#4a7a5a';
            ctx.fill();

            // Pupil
            ctx.beginPath();
            ctx.arc(cx, cy, radius * 0.28, 0, Math.PI * 2);
            ctx.fillStyle = '#111';
            ctx.fill();

            // Highlight
            ctx.beginPath();
            ctx.arc(cx - radius * 0.15, cy - radius * 0.15, radius * 0.12, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255,255,255,0.7)';
            ctx.fill();
        }

        function drawDot(x, y, color, radius) {
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.lineWidth = 1;
            ctx.stroke();
        }

        function drawArrow(x1, y1, x2, y2, color, lineWidth) {
            const headLen = 14;
            const angle = Math.atan2(y2 - y1, x2 - x1);

            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.strokeStyle = color;
            ctx.lineWidth = lineWidth;
            ctx.stroke();

            // Arrowhead
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - headLen * Math.cos(angle - Math.PI / 6), y2 - headLen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(x2 - headLen * Math.cos(angle + Math.PI / 6), y2 - headLen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();
        }

        function draw() {
            ctx.clearRect(0, 0, W, H);

            // Draw eyes
            drawEye(leftEyeX, eyeY, 22);
            drawEye(rightEyeX, eyeY, 22);

            // Labels
            ctx.font = '13px sans-serif';
            ctx.fillStyle = '#888';
            ctx.textAlign = 'center';
            ctx.fillText('Left eye', leftEyeX, eyeY + 40);
            ctx.fillText('Right eye', rightEyeX, eyeY + 40);

            // Draw dots
            drawDot(dotX, blueDotY, '#4488ff', 10);
            drawDot(dotX, redDotY, '#ff4444', 10);

            // Draw saved arrows
            for (const arrow of arrows) {
                drawArrow(arrow.x1, arrow.y1, arrow.x2, arrow.y2, '#ffcc44', 2);
            }

            // Draw in-progress arrow
            if (startPoint && mousePos) {
                drawArrow(startPoint.x, startPoint.y, mousePos.x, mousePos.y, 'rgba(255,204,68,0.5)', 2);
            }
        }

        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (W / rect.width);
            const y = (e.clientY - rect.top) * (H / rect.height);

            if (!startPoint) {
                startPoint = { x, y };
                statusEl.textContent = 'Click again to place the arrowhead.';
            } else {
                arrows.push({ x1: startPoint.x, y1: startPoint.y, x2: x, y2: y });
                startPoint = null;
                mousePos = null;
                statusEl.textContent = '';
                draw();
            }
        });

        canvas.addEventListener('mousemove', (e) => {
            if (startPoint) {
                const rect = canvas.getBoundingClientRect();
                mousePos = {
                    x: (e.clientX - rect.left) * (W / rect.width),
                    y: (e.clientY - rect.top) * (H / rect.height)
                };
                draw();
            }
        });

        resetBtn.addEventListener('click', () => {
            arrows = [];
            startPoint = null;
            mousePos = null;
            statusEl.textContent = '';
            draw();
        });

        draw();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Walk Simulation - Interactive</title>
    <style>
        body {
            margin: 0;
            padding: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            height: 100vh;
            box-sizing: border-box;
            overflow: hidden;
        }
        
        h2 {
            color: #333;
            margin: 0 0 8px 0;
            font-size: 18px;
        }
        
        #canvas {
            border: 2px solid #333;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        button {
            padding: 5px 14px;
            font-size: 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            white-space: nowrap;
            min-width: 55px;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        button.running {
            background-color: #f44336;
        }
        
        button.running:hover {
            background-color: #da190b;
        }
        
        .controls {
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            width: 480px;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 6px;
            background: white;
            padding: 6px 8px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .slider-label {
            font-size: 11px;
            color: #666;
            white-space: nowrap;
        }
        
        .slider-value {
            font-weight: bold;
            color: #333;
            font-size: 11px;
            white-space: nowrap;
            min-width: 30px;
            text-align: right;
        }
        
        input[type="range"] {
            width: 60px;
            height: 4px;
            background: #ddd;
            outline: none;
            border-radius: 2px;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: #4CAF50;
            cursor: pointer;
            border-radius: 50%;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #4CAF50;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <h2>Random Walk Simulation</h2>
    <canvas id="canvas" width="480" height="280"></canvas>
    <div class="controls">
        <button id="controlBtn">Go</button>
        <div class="slider-container">
            <span class="slider-label">step size:</span>
            <input type="range" id="stepSlider" min="0.001" max="1" step="0.001" value="0.3">
            <span class="slider-value" id="stepValue" style="min-width: 50px;">0.300 μm</span>
        </div>
        <div class="slider-container">
            <span class="slider-label">steps per second:</span>
            <input type="range" id="speedSlider" min="0.5" max="100" step="0.5" value="1">
            <span class="slider-value" id="speedValue">1.0</span>
        </div>
    </div>
    
    <script>
        // Get canvas and context
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const controlBtn = document.getElementById('controlBtn');
        const stepSlider = document.getElementById('stepSlider');
        const speedSlider = document.getElementById('speedSlider');
        const stepValue = document.getElementById('stepValue');
        const speedValue = document.getElementById('speedValue');
        
        // Simulation parameters
        const NUM_DOTS = 50;
        const WIDTH = canvas.width;
        const HEIGHT = canvas.height;
        const RANGE = 50; // μm range for X axis
        const RANGE_Y = 30; // μm range for Y axis (adjusted for canvas)
        
        // Variables
        let STEP_SIZE = 0.3; // μm
        let DOT_RADIUS = 4; // pixels (visual radius)
        let SPEED = 1; // steps per second
        
        // Scaling
        const SCALE = WIDTH / (2 * RANGE);
        
        // State variables
        let running = false;
        let dots = [];
        let animationId = null;
        let lastStepTime = 0;
        
        // Dot class
        class Dot {
            constructor() {
                // Start spread across full canvas in μm units
                this.x = (Math.random() - 0.5) * 2 * RANGE;
                this.y = (Math.random() - 0.5) * 2 * RANGE_Y;
                
                // Random color
                this.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }
            
            move() {
                // Random direction (up, down, left, right)
                const directions = [
                    { dx: -1, dy: 0 },  // left
                    { dx: 1, dy: 0 },   // right
                    { dx: 0, dy: -1 },  // up
                    { dx: 0, dy: 1 }    // down
                ];
                const dir = directions[Math.floor(Math.random() * 4)];
                
                // Move in μm
                this.x += dir.dx * STEP_SIZE;
                this.y += dir.dy * STEP_SIZE;
            }
            
            draw() {
                // Convert μm coordinates to canvas pixels
                const drawX = (this.x + RANGE) * SCALE;
                const drawY = (RANGE_Y - this.y) * SCALE;
                
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(drawX, drawY, DOT_RADIUS, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        // Initialize dots
        function init() {
            dots = [];
            for (let i = 0; i < NUM_DOTS; i++) {
                dots.push(new Dot());
            }
        }
        
        // Setup event listeners
        controlBtn.addEventListener('click', function() {
            running = !running;
            controlBtn.textContent = running ? "Pause" : "Go";
            controlBtn.className = running ? "running" : "";
        });
        
        stepSlider.addEventListener('input', function() {
            STEP_SIZE = parseFloat(this.value);
            stepValue.textContent = STEP_SIZE.toFixed(3) + " μm";
        });
        
        speedSlider.addEventListener('input', function() {
            SPEED = parseFloat(this.value);
            speedValue.textContent = SPEED.toFixed(1);
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.code === 'Space') {
                e.preventDefault();
                controlBtn.click();
            } else if (e.key.toLowerCase() === 'r') {
                init();
                running = false;
                controlBtn.textContent = "Go";
                controlBtn.className = "";
            }
        });
        
        // Animation loop
        function animate(currentTime) {
            const deltaTime = currentTime - lastStepTime;
            const stepInterval = 1000 / SPEED;
            
            if (deltaTime >= stepInterval) {
                // Clear canvas
                ctx.clearRect(0, 0, WIDTH, HEIGHT);
                
                // Update and draw dots
                if (running) {
                    dots.forEach(dot => dot.move());
                }
                
                dots.forEach(dot => dot.draw());
                
                lastStepTime = currentTime;
            }
            
            animationId = requestAnimationFrame(animate);
        }
        
        // Initialize and start
        init();
        requestAnimationFrame(animate);
    </script>
</body>
</html>
